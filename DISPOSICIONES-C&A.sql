			SELECT 'C&A' AS SOCIO, 'PLCC' AS PRODUCTO, NUM_CTA_CTAF AS CUENTA, DAT_ADES_CTAF AS APROBACION, DAT_TRANS_SAQ AS FECHA
				, YEAR(DAT_TRANS_SAQ) AS ANIO, MONTH(DAT_TRANS_SAQ) AS MES
				, (VAL_TRANS_SAQ - VAL_JUROS_PARC_SAQ) AS MONTO
				, CRE.VAL_DADO_ORIG_LKP AS Cre_Vision, CRE.DES_PLANO_CRED_LKP AS Des_Credito
				, TRA.VAL_DADO_ORIG_LKP AS TXN_Vision, TRA.DES_TIPO_TRANS_LKP AS Des_Txn
				, CASE WHEN TXN_Vision IN ('310085','311085','310064','311064','310075','311075') THEN 'REVERSA' ELSE 'D' END AS TRANSACCION
				, CASE WHEN TXN_Vision IN ('310085','311085','310064','311064','310075','311075') THEN NULL ELSE Cuenta END AS CuentaReal
				, CASE WHEN TXN_Vision IN ('310085','311085','310064','311064','310075','311075') THEN (Monto * -1) ELSE Monto END AS MontoReal
				, CASE WHEN 	Des_Credito LIKE '%C&A%' THEN 'ON' ELSE 'OF' END AS TIPOTXN
				, CASE WHEN DAT_PRI_SAQ_CTAF =  DAT_TRANS_SAQ THEN 'P' ELSE 'R' END TIPORETIRO
			FROM CONTA_FINANCIAMENTO_V
			INNER JOIN CARTAO_FINANCIAMENTO_V ON ID_CTA_CTAF = ID_CTA_CARF
			INNER JOIN  SAQUE_V  ON ID_CAR_SAQ =  ID_CAR_CARF
			INNER JOIN PLANO_CREDITO_V CRE ON ID_PLANO_CRED_LKP = ID_PLANO_CRED_SAQ
			INNER JOIN TIPO_TRANSACAO_V TRA ON ID_TIPO_TRANS_LKP = ID_TIPO_TRANS_SAQ
			INNER JOIN CANAL_V ON  ID_CANA_SAQ = ID_CANA_CAN 
				AND TRA.VAL_DADO_ORIG_LKP IN ('310085','311085','310064','311064','310075','311075','310039','311039','310038','311038','310035','311035','310051','311051','310054','311054')
				AND CRE.VAL_DADO_ORIG_LKP NOT IN ('31090000', '31008500', '31190000', '31108500')
				AND ID_PROD_CTAF IN  ('11','14','19','30')
				AND DAT_TRANS_SAQ >= '2023-01-01' 
				AND TRANSACCION ='D'
			
			UNION ALL
			
			SELECT 'C&A' AS SOCIO, 'BK' AS PRODUCTO, NUM_CTA_CTAF AS CUENTA, DAT_ADES_CTAF AS APROBACION, DAT_TRANS_SAQ AS FECHA 
				, YEAR(DAT_TRANS_SAQ) AS ANIO, MONTH(DAT_TRANS_SAQ) AS MES
				, (VAL_TRANS_SAQ - VAL_JUROS_PARC_SAQ) AS MONTO
				, CRE.VAL_DADO_ORIG_LKP AS Cre_Vision, CRE.DES_PLANO_CRED_LKP AS Des_Credito
				, TRA.VAL_DADO_ORIG_LKP AS TXN_Vision, TRA.DES_TIPO_TRANS_LKP AS Des_Txn
				, CASE WHEN TXN_Vision IN ('320085','320086','320064','320075')THEN 'REVERSA' ELSE 'D' END AS TRANSACCION
				, CASE WHEN TXN_Vision IN ('320085','320086','320064','320075')THEN NULL ELSE Cuenta END AS CuentaReal
				, CASE WHEN TXN_Vision IN ('320085','320086','320064','320075') THEN (Monto * -1) ELSE Monto END AS MontoReal
				, CASE WHEN 	Des_Credito LIKE '%C&A%' THEN 'ON' ELSE 'OF' END AS TIPOTXN
				, CASE WHEN DAT_PRI_SAQ_CTAF =  DAT_TRANS_SAQ THEN 'P' ELSE 'R' END TIPORETIRO
			FROM CONTA_FINANCIAMENTO_V
			INNER JOIN CARTAO_FINANCIAMENTO_V ON ID_CTA_CTAF = ID_CTA_CARF
			INNER JOIN  SAQUE_V  ON ID_CAR_SAQ =  ID_CAR_CARF
			INNER JOIN PLANO_CREDITO_V CRE ON ID_PLANO_CRED_LKP = ID_PLANO_CRED_SAQ
			INNER JOIN TIPO_TRANSACAO_V TRA ON ID_TIPO_TRANS_LKP = ID_TIPO_TRANS_SAQ
			INNER JOIN CANAL_V ON  ID_CANA_SAQ = ID_CANA_CAN 
				AND TRA.VAL_DADO_ORIG_LKP IN('320085','320086','320064','320075','320037','320038','320039','320035','320051','320054','320055')
				AND CRE.VAL_DADO_ORIG_LKP NOT IN ('32008500')
				AND ID_PROD_CTAF IN  ('9')
				AND DAT_TRANS_SAQ >= '2023-01-01' 
				AND TRANSACCION ='D'
		
			UNION ALL
			
			SELECT 'C&A' AS SOCIO, 'PL' AS PRODUCTO, NUM_CTA_CTAF AS CUENTA, DAT_ADES_CTAF AS APROBACION, DAT_TRANS_SAQ AS FECHA
				, YEAR(DAT_TRANS_SAQ) AS ANIO, MONTH(DAT_TRANS_SAQ) AS MES
				, (VAL_TRANS_SAQ - VAL_JUROS_PARC_SAQ) AS MONTO
				, CRE.VAL_DADO_ORIG_LKP AS Cre_Vision, CRE.DES_PLANO_CRED_LKP AS Des_Credito
				, TRA.VAL_DADO_ORIG_LKP AS TXN_Vision, TRA.DES_TIPO_TRANS_LKP AS Des_Txn
				, CASE WHEN TXN_Vision IN ('340085','341085','341064','340064','341075','340075')  THEN 'REVERSA' ELSE 'D' END AS TRANSACCION
				, CASE WHEN TXN_Vision IN ('340085','341085','341064','340064','341075','340075')  THEN NULL ELSE Cuenta END AS CuentaReal
				, CASE WHEN TXN_Vision IN ('340085','341085','341064','340064','341075','340075') THEN (Monto * -1) ELSE Monto END AS MontoReal
				, CASE WHEN 	Des_Credito LIKE '%C&A%' THEN 'ON' ELSE 'OF' END AS TIPOTXN
				, CASE WHEN DAT_PRI_SAQ_CTAF =  DAT_TRANS_SAQ THEN 'P' ELSE 'R' END TIPORETIRO
			FROM CONTA_FINANCIAMENTO_V
			INNER JOIN CARTAO_FINANCIAMENTO_V ON ID_CTA_CTAF = ID_CTA_CARF
			INNER JOIN  SAQUE_V  ON ID_CAR_SAQ =  ID_CAR_CARF
			INNER JOIN PLANO_CREDITO_V CRE ON ID_PLANO_CRED_LKP = ID_PLANO_CRED_SAQ
			INNER JOIN TIPO_TRANSACAO_V TRA ON ID_TIPO_TRANS_LKP = ID_TIPO_TRANS_SAQ
			INNER JOIN CANAL_V ON  ID_CANA_SAQ = ID_CANA_CAN 
				AND TRA.VAL_DADO_ORIG_LKP IN ('340085','341085','341064','340064','341075','340075','341038','340038','340035','341039','340039','340051','341051','341055','340055')
				AND CRE.VAL_DADO_ORIG_LKP NOT IN ('34008500','34090100')
				AND ID_PROD_CTAF IN ('18','31')
				AND DAT_TRANS_SAQ >= '2023-01-01' 
				AND TRANSACCION ='D'
	